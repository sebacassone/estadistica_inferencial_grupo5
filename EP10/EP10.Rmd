---
title: "EP10"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Comenzamos leyendo el archivo.
```{r}
# Leer los datos
nombre_archivo <- "EP09 Datos.csv"
carpeta <- "/home/seba/Documentos/ejercicios_R/EI/estadistica_inferencial_grupo5/EP10"
ruta <- file.path(carpeta, nombre_archivo)
datos <- read.csv2(ruta, stringsAsFactors = TRUE)

```

Luego, se calcula la columna del IMC para poder insertarlo en el dataframe.

```{r}
# Calcular el IMC
datos$IMC <- datos$Weight / ((datos$Height*1/100)^2)
# Filtrar mujeres
mujeres <- subset(datos, Gender == 0)
print(cor(mujeres))
```

Con la función cor() se obtienen las correlaciones entre variables predictoras y la variable de respuesta no aún dicotómica para determinar que variables predictoras nos podrían ayudar a predecir el IMC, con esto pudimos determinar que la variable predictora que nos podría con esta tarea es Waist Girth: 0.8707, además que con investigación que pudimos realizar (https://fundaciondelcorazon.com/prensa/notas-de-prensa/2264-medida-perimetro-abdominal-es-indicador-enfermedad-cardiovascular-mas-fiable-imc-.html) pudimos determinar que esta variable predictora nos servirá en este caso.
Además, se obtiene la variable de respuesta de tipo dicotómica y agrega al dataframe. Luego, obtenemos las muestras necesarias para resolver el problema. 

```{r}
#Ahora podemos construir un modelo de regresión logística para predecir la variable EN, de acuerdo con las siguientes instrucciones:
set.seed(1412)

# Crear la variable dicotómica EN (estado nutricional)
mujeres$EN <- ifelse(mujeres$IMC >= 23.2, 1, 0)

# Separar mujeres con "Sobrepeso" y "No sobrepeso"
mujeres_sobrepeso <- subset(mujeres, EN == 1)
mujeres_no_sobrepeso <- subset(mujeres, EN == 0)

# Seleccionar 75 mujeres de cada grupo (75 "Sobrepeso" y 75 "No sobrepeso")
muestra_sobrepeso <- mujeres_sobrepeso[sample(nrow(mujeres_sobrepeso), 75), ]
muestra_no_sobrepeso <- mujeres_no_sobrepeso[sample(nrow(mujeres_no_sobrepeso), 75), ]

# Dividir la muestra en dos conjuntos
# 100 personas (50 con EN "Sobrepeso" y 50 con EN "No sobrepeso") para el modelo RLO
entrenamiento <- rbind(
  muestra_sobrepeso[1:50, ],
  muestra_no_sobrepeso[1:50, ]
)

# 50 personas (25 con EN "Sobrepeso" y 25 con EN "No sobrepeso") para la evaluación
evaluacion <- rbind(
  muestra_sobrepeso[51:75, ],
  muestra_no_sobrepeso[51:75, ]
)
```

3. Recordar las ocho posibles variables predictoras seleccionadas de forma aleatoria en el ejercicio anterior.

- Biacromial.diameter 	Diámetro biacromial (a la altura de los hombros) 
- Biiliac.diameter 	Diámetro biiliaco (a la altura de la pelvis) 
- Bitrochanteric.diameter 	Diámetro bitrocantéreo (a la altura de las caderas) 
- Chest.depth 	Profundidad del pecho (entre la espina y el esternón a la altura de los pezones) 	cm
- Chest.diameter 	Diámetro del pecho (a la altura de los pezones)
- Elbows.diameter 	Suma de los diámetros de los codos
- Wrists.diameter 	Suma de los diámetros de las muñecas
- Knees.diameter 	Suma de los diámetros de las rodillas

4. Se construye el modelo de regresión logística

```{r}
modelo <- glm(EN ~ Waist.Girth, family = binomial(link = "logit"), entrenamiento)
print(summary(modelo))
```


---
title: "EP08"
author: "Sebastián Cassone"
date: "`r Sys.Date()`"
output: html_document
---


```{r}
library(dplyr)

# Leer los datos
datos = read.csv2("C:/Users/josef/OneDrive/Escritorio/EST/estadistica_inferencial_grupo5/EP09/EP09 Datos.csv")

set.seed(6604)

# Se filtran a las mujeres
datos <- datos %>% filter(datos$Gender == 0)

# Se obtiene una muestra aleatoria de 100 mujeres.
datos_filtrados <- datos %>% sample_n(100)
datos_filtrados

correlaciones = cor(datos_filtrados)
print(correlaciones)


# Dividir los datos en conjuntos de entrenamiento y prueba
indices_entrenamiento = sample(1:nrow(datos_filtrados), 0.7 * nrow(datos_filtrados))
datos_entrenamiento = datos_filtrados[indices_entrenamiento, ]
datos_prueba = datos_filtrados[-indices_entrenamiento, ]

#Modelo nulo

modelo1 = lm(Weight ~ Thigh.Girth, data = datos_entrenamiento)  #RLS var: Thigh
# Ajustar el modelo de regresión lineal múltiple
modelo_completo = modelo <- lm(Weight ~Biacromial.diameter + Biiliac.diameter + Bitrochanteric.diameter + Chest.depth + Chest.diameter + Elbows.diameter + Wrists.diameter + Knees.diameter + Thigh.Girth, data = datos_entrenamiento)




# Resumen de los modelos
cat("\n\n")
cat("Modelo 1:Regresion Lineal Simple, variable predictora Thig\n")
cat("------------------------------------------------\n")
print(summary(modelo1))


cat("\n\n")
cat("Modelo Completo:Regresion Lineal Multiple - Modelo completo\n")
cat("------------------------------------------------\n")
print(summary(modelo_completo))




#Evaluar variables a incorporar
print(add1(modelo1, scope = modelo_completo))
cat("\n\n")

#Agregamos la variable con menor AIC, Elbows.diameter (218.84)
modelo2 = update(modelo1, . ~ . + Elbows.diameter)
print(summary(modelo1))

#Evaluar variables a incorporar
print(add1(modelo2, scope = modelo_completo))

#Agregamos la variable con menor AIC, Chest.diameter (204.57)
modelo3 = update(modelo2, . ~ . + Chest.diameter)

#Evaluar variables a incorporar 
print(add1(modelo3, scope = modelo_completo))

#Agregamos la variable con menor AIC, Chest.depth (199.28)
modelo4 = update(modelo3, . ~ . + Chest.depth)

#Evaluar variables  a incorporar
print(add1(modelo4, scope = modelo_completo, test = "F"))

#Agregamos la variable con menor AIC, Biiliac.diameter (195.65)
modelo5 = update(modelo4, . ~ . + Biiliac.diameter)

#Evaluar variables a incorporar
print(add1(modelo5, scope = modelo_completo))

#Agregamos la variable con menor AIC, Biacromial.diameter(195.65)
modelo6 = update(modelo5, . ~ . + Biacromial.diameter)


```

Una vez que se obtuvieron los datos, se decidió descartar como variables predictoras, las siguientes ocho:
- Biacromial.diameter 	Diámetro biacromial (a la altura de los hombros) 
- Biiliac.diameter 	Diámetro biiliaco (a la altura de la pelvis) 
- Bitrochanteric.diameter 	Diámetro bitrocantéreo (a la altura de las caderas) 
- Chest.depth 	Profundidad del pecho (entre la espina y el esternón a la altura de los pezones) 	cm
- Chest.diameter 	Diámetro del pecho (a la altura de los pezones)
- Elbows.diameter 	Suma de los diámetros de los codos
- Wrists.diameter 	Suma de los diámetros de las muñecas
- Knees.diameter 	Suma de los diámetros de las rodillas

Luego, de las variables predictoras restantes se decidió considerar la variable predictora para el RLS Thigh.Girth que corresponde al Grosor promedio de ambos muslos bajo el pliegue del glúteo.

```{r}
library(dplyr)

# Leer los datos
datos = read.csv2("/home/seba/Documentos/ejercicios_R/EI/estadistica_inferencial_grupo5/EP09 Datos.csv")

set.seed(6604)

# Se filtran a las mujeres
datos <- datos %>% filter(datos$Gender == 0)

# Se obtiene una muestra aleatoria de 100 mujeres.
datos_filtrados <- datos %>% sample_n(100)
datos_filtrados
```